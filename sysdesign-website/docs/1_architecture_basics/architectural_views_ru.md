# Архитектурные представления

Архитектура ПО — это многомерная сущность, требующая множественных перспектив для понимания и документации. **Архитектурные представления** отображают различные аспекты системы для передачи специфических задач различным заинтересованным сторонам.
## Модель архитектурных представлений 4+1

Модель архитектурных представлений 4+1, разработанная Филиппом Крухтеном, предоставляет четыре фундаментальных представления плюс сценарии для комплексного документирования архитектуры ПО:

### 1. Логическое представление

Логическое представление описывает функциональные требования системы и то, как система предоставляет услуги конечным пользователям. Оно фокусируется на функциональности системы, показывая ключевые абстракции и объектные модели. Это представление демонстрирует, что делает система и как различные функциональные элементы соотносятся друг с другом.

Логическое представление обычно показывает доменные объекты, их отношения и ключевые поведенческие паттерны, используя диаграммы классов, диаграммы объектов и конечные автоматы. Оно подчеркивает функциональную декомпозицию и иерархию абстракций, которая поддерживает основную бизнес-логику системы и пользовательские требования.

### 2. Представление процессов

Представление процессов (иногда также называемое представлением компонентов и коннекторов, C&C) показывает runtime-архитектуру системы, включая процессы, потоки и их взаимодействия. Это представление затрагивает конкурентность, распределение, задачи системного интегратора и характеристики производительности.

Представление процессов фокусируется на элементах во время выполнения — процессах, сервисах, базах данных, очередях сообщений — и механизмах коммуникации между ними. В отличие от логического представления, это показывает, что на самом деле происходит при выполнении системы. Оно часто фокусируется на более высоком уровне, чем логическое представление, и может содержать множественные развертываемые и инфраструктурные единицы. Общие паттерны включают взаимодействия клиент-сервер, обмен сообщениями по модели публикации-подписки и конвейерную обработку. Представления процессов подчеркивают конкурентность, распределение, характеристики производительности и отказоустойчивость.

### 3. Представление разработки

Представление разработки описывает статическую организацию модулей ПО, библиотек, подсистем и инструментов разработки. Это представление затрагивает задачи управления ПО и показывает, как система организована с точки зрения разработчика. Оно рассматривает структуру кода, зависимости сборки и организацию команды разработки.

Представление разработки более конкретно, чем традиционные модульные представления — оно показывает реальную организацию кода (пакеты, библиотеки, артефакты сборки), а не абстрактную функциональную декомпозицию.

Представление разработки показывает статическую организацию модулей кода, пакетов и их зависимостей. Оно позволяет разработчикам понимать структуру кодовой базы, управлять зависимостями сборки, организовывать команды разработки и обеспечивать архитектурные ограничения через границы модулей.

### 4. Физическое представление

Физическое представление описывает отображение ПО на аппаратное обеспечение и показывает физическое развертывание системы. Это представление показывает, как программные компоненты распределяются по инфраструктуре.

Физическое представление отображает программные элементы на аппаратную инфраструктуру, показывая топологию развертывания, сетевые соединения, спецификации аппаратного обеспечения и распределение ресурсов. Это представление поддерживает планирование мощностей, оптимизацию производительности, планирование восстановления после сбоев и управление инфраструктурой.

## Представления качества

Помимо структурных представлений и C4 (которую мы рассмотрим позже), представления качества рассматривают специфические задачи заинтересованных сторон, фокусируясь на конкретных атрибутах качества или нефункциональных требованиях. В то время как модель 4+1 охватывает основные структурные аспекты системы, представления качества накладывают дополнительные перспективы, которые пересекают множественные структурные элементы.

**Что такое представления качества?** Представления качества — это архитектурные перспективы, которые подчеркивают специфические качества системы, такие как безопасность, производительность, надежность или масштабируемость. В отличие от структурных представлений, которые показывают "что" и "где", представления качества показывают "насколько хорошо" система достигает определенных характеристик.

Например, **представление безопасности** фокусируется на механизмах защиты и анализе поверхности атак. Показывает границы безопасности, зоны доверия, потоки аутентификации/авторизации, точки шифрования данных и механизмы контроля доступа. Ключевые элементы включают межсетевые экраны, балансировщики нагрузки с завершением SSL, шлюзы аутентификации (OAuth, JWT), системы управления секретами и зашифрованные хранилища данных. Это представление позволяет командам безопасности идентифицировать уязвимости, планировать стратегии защиты и обеспечивать соответствие требованиям безопасности.

**Представление производительности** подчеркивает отзывчивость системы, пропускную способность и характеристики масштабируемости. Показывает критичные для производительности компоненты, такие как сеть доставки контента для глобальной доставки контента, слои кэширования (кластеры Redis), автомасштабируемые уровни приложений и оптимизированные конфигурации баз данных с репликами для чтения. Включает метрики производительности, идентификацию узких мест и стратегии оптимизации. Это представление позволяет инженерам по производительности понимать поведение системы под нагрузкой и планировать улучшения мощности.

## Комбинирование представлений

Документирование архитектуры через отдельные представления обеспечивает подход "разделяй и властвуй", но поскольку все структуры служат одной цели, они часто имеют сильные ассоциации, которыми архитекторы должны управлять.

Когда представления тесно связаны, **комбинированные представления** могут эффективно показать эти ассоциации, объединив элементы и отношения из множественных представлений. Простейший подход — создание **наложений**, которые комбинируют информацию из двух отдельных представлений, сохраняя оригинальные типы элементов и отношений. Это работает лучше всего, когда представления имеют тесные отношения и сильные ассоциации между элементами, делая комбинированную структуру более понятной, чем рассмотрение их отдельно. Однако избегайте перегрузки комбинированных представлений слишком большим количеством отображений.

## Модель C4: Современная архитектурная визуализация

Хотя модель C4 не является точно архитектурными 'представлениями' в традиционном смысле, она представляет собой дополнительный метод документирования, который весьма релевантен, поскольку предоставляет стандартизированный, иерархический подход к визуализации архитектуры ПО на различных уровнях абстракции. Она соединяет разрыв между высокоуровневым системным контекстом и детальной реализацией, предлагая практический framework, который может использоваться наряду с архитектурными представлениями 4+1 или интегрированно с ними.

Модель C4 состоит из четырех уровней абстракции:

### Уровень 1: Системный контекст

Показывает программную систему, которую вы строите, и то, как она вписывается в мир с точки зрения людей, которые ее используют, и других программных систем, с которыми она взаимодействует. Эта диаграмма фокусируется на людях (акторах, ролях, персонах и т.д.) и программных системах, а не на технологиях, протоколах и других низкоуровневых деталях. Она отвечает на вопрос "Что это за система и как она вписывается в мир?"

### Уровень 2: Диаграмма контейнеров

Увеличивает программную систему и показывает контейнеры (приложения, хранилища данных, microservices и т.д.), которые составляют эту программную систему. Технологические решения также являются ключевой частью этой диаграммы. Контейнер представляет приложение или хранилище данных и является чем-то, что должно работать для функционирования общей программной системы. Этот уровень показывает общую форму архитектуры и технологические решения.

### Уровень 3: Диаграмма компонентов

Увеличивает отдельный контейнер, чтобы показать компоненты внутри него. Эти компоненты должны отображаться на реальные абстракции (например, группировку кода) в вашей кодовой базе. Компоненты — это основные структурные строительные блоки вашего кода — думайте о них как о коллекции функциональности за четко определенным интерфейсом. Эта диаграмма идентифицирует основные структурные строительные блоки и их взаимодействия в рамках конкретного контейнера.

### Уровень 4: Диаграмма кода

Увеличивает отдельный компонент, чтобы показать, как этот компонент реализован на уровне кода, показывая элементы кода (интерфейсы, классы и т.д.), которые составляют компонент. Этот уровень предоставляет детали реализации, которые нужны разработчикам, хотя часто лучше генерировать их автоматически из IDE, а не поддерживать вручную.

**Интеграция C4 + DDD** работает особенно хорошо вместе — системный контекст отображается на границы доменов, диаграммы контейнеров показывают bounded contexts как развертываемые единицы, а диаграммы компонентов раскрывают доменные агрегаты и сервисы в рамках каждого контекста. **Event Storming** предоставляет подход совместных workshop'ов для обнаружения границ доменов, агрегатов и bounded contexts через отображение бизнес-событий. Это напрямую информирует логическое представление, раскрывая естественную функциональную декомпозицию на основе доменных событий. **Context Mapping** предлагает стратегические паттерны проектирования для определения отношений между bounded contexts (Shared Kernel, Customer/Supplier, Anti-corruption Layer), что напрямую транслируется в документацию представления процессов, показывающую, как различные доменные сервисы взаимодействуют.

## Enterprise Architecture Frameworks: Комплексные системы представлений

Хотя модель 4+1 и C4 предоставляют фундаментальные подходы, несколько enterprise architecture фреймворков предлагают комплексные, стандартизированные системы представлений из коробки:

**ArchiMate** (The Open Group) является наиболее комплексным, предоставляя структурированный язык моделирования с предопределенными слоями и точками зрения:
- **Три основных слоя**: Business (процессы, акторы, сервисы), Application (компоненты, интерфейсы), Technology (инфраструктура, сети)
- **Cross-cutting аспекты**: Motivation (цели, требования), Strategy (возможности, ресурсы), Implementation & Migration
- **25+ стандартных перспектив**: Service Realization, Process Cooperation, Application Usage, Infrastructure Usage и др.

**TOGAF ADM** предоставляет Architecture Development Method со стандартными архитектурными доменами: Business, Data, Application и Technology Architecture.

**DoDAF/MODAF** (Defense frameworks) предлагают комплексные системы точек зрения:
- **Operational Viewpoints**: Миссии, процессы, активности
- **Systems Viewpoints**: Системы, интерфейсы, функциональность
- **Technical Standards Viewpoints**: Стандарты, правила, критерии

Эти frameworks устраняют ad-hoc архитектурную документацию, предоставляя стандартизированные словари, системы нотаций и предопределенные структуры представлений. ArchiMate, в частности, предлагает наиболее зрелое решение "из коробки" для организаций, требующих комплексного архитектурного моделирования с минимальными накладными расходами на настройку.

## Заключение

Архитектурные представления — это инструменты коммуникации, которые обеспечивают эффективное сотрудничество в организациях разработки. Модель 4+1, диаграммы C4 и методы документирования поведения создают архитектурную документацию, которая служит заинтересованным сторонам.

Эффективная архитектурная документация начинается с потребностей заинтересованных сторон, использует подходящие представления и нотации и поддерживает документацию как живой артефакт, который развивается вместе с системой.